<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Bo Yu</title><link href="http://yubo.info/" rel="alternate"></link><link href="http://yubo.info/feeds/algorithm.atom.xml" rel="self"></link><id>http://yubo.info/</id><updated>2012-03-24T16:30:00-07:00</updated><entry><title>Random point picking inside an arbitraryÂ polygon</title><link href="http://yubo.info/posts/random-point-picking/" rel="alternate"></link><updated>2012-03-24T16:30:00-07:00</updated><author><name>Bo Yu</name></author><id>tag:yubo.info,2012-03-24:posts/random-point-picking/</id><summary type="html">&lt;p&gt;I come across the problem of randomly generating geographic locations (as points) inside a certain area (as polygons) for a simulation project. A simple solution is to generate and test random points until one is inside the polygon, which is really unpredictable of the time it takes. The solution here is based on &lt;a href="http://stackoverflow.com/questions/240778/random-points-inside-a-polygon"&gt;a post on Stack Overflow&lt;/a&gt;, aiming to generate a point from a uniform distribution within an arbitrary (convex) polygon. This is achieved in a few&amp;nbsp;steps:&lt;/p&gt;
&lt;h1&gt;Step&amp;nbsp;1&lt;/h1&gt;
&lt;p&gt;&lt;a href="http://en.wikipedia.org/wiki/Polygon_triangulation"&gt;Triangulate the polygon&lt;/a&gt; i.e. find the set of triangles with pairwise non-intersecting interiors whose union is the whole polygon. An easy-to-use open source library (poly2tri) for doing polygon triangulation can be found at &lt;a href="http://code.google.com/p/poly2tri/"&gt;here&lt;/a&gt;. It follows the sweep-line algorithm for constrained Delaunay&amp;nbsp;triangulation.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Polygon triangulation" src="http://www.geom.uiuc.edu/~samuelp/final_delaunay.gif" /&gt;&lt;/p&gt;
&lt;h1&gt;Step&amp;nbsp;2&lt;/h1&gt;
&lt;p _="%" endcodeblock="endcodeblock"&gt;Pick one of the triangles randomly. The probability of a triangle getting picked equals to the area ratio between each triangle and the whole polygon. Each triangle is stored as a two-element tuple: the first element stores the coordinates, and the second is the area ratio as the weight. Then the randomly picking a triangle can be done by calling the following &lt;code&gt;pick_triangle&lt;/code&gt;function.
    {% codeblock Pick triangles randomly lang:python %}
    import random
    def pick_triangle(triangles):
        p = random.uniform(0.0, 1.0)
        for triangle, weight in triangles:
            if p &amp;lt; weight:
                break
            p = p - weight
        return&amp;nbsp;triangle&lt;/p&gt;
&lt;h1&gt;Step&amp;nbsp;3&lt;/h1&gt;
&lt;p&gt;Randomly pick a point inside the chosen triangle, following &lt;a href="http://mathworld.wolfram.com/TrianglePointPicking.html"&gt;the description on Mathworld&lt;/a&gt;. Let &lt;code&gt;v0&lt;/code&gt;, &lt;code&gt;v1&lt;/code&gt;, &lt;code&gt;v2&lt;/code&gt; be vertices of the triangle, represented by their coordinates, so that &lt;code&gt;v0 = (x0,y0)&lt;/code&gt;, etc. Then we generate two random numbers &lt;code&gt;p0&lt;/code&gt; and &lt;code&gt;p1&lt;/code&gt;, both drawn uniformly from the interval &lt;code&gt;[0,1]&lt;/code&gt;. Then we calculate the coordinate of the random point &lt;code&gt;v&lt;/code&gt; by &lt;code&gt;v = v0 + p0*(v1-v0) + p1*(v2-v0)&lt;/code&gt;. &lt;br /&gt; Note that with probability of &lt;code&gt;0.5&lt;/code&gt;, &lt;code&gt;v&lt;/code&gt; lies outside the triangle. Whether &lt;code&gt;v&lt;/code&gt; lies inside or outside the triangle can be easily tested: if &lt;code&gt;p0 + p1 &amp;gt; 1&lt;/code&gt;, then &lt;code&gt;v&lt;/code&gt; is outside the triangle (See the discussion &lt;a href="http://www.blackpawn.com/texts/pointinpoly/default.html"&gt;here&lt;/a&gt;). In that case, we can generate a new point &lt;code&gt;v'&lt;/code&gt; by &lt;code&gt;v' = v0 + (1-p0)*(v1-v0) + (1-p1)*(v2-v0)&lt;/code&gt;, which will be inside the&amp;nbsp;triangle.&lt;/p&gt;</summary><category term="algorithm"></category></entry></feed>